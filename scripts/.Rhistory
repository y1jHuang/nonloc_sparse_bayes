df <- data.frame(X, U, Y0, Y1, A) %>%
mutate(Y=ifelse(A, Y1, Y0))
set.seed(2610)
n = 10000
X = rnorm(n, 0, 1)
U = rnorm(n, 0, 2)
Y0 = rnorm(n, 0, 1)
Y1 = rnorm(n, Y0 + 0.8 + 0.1 *X + 0.3 *U, 0.5)
A = rbinom(n, 1, plogis (-1 + 1.0*X + 0.5*U))
df <- data.frame(X, U, Y0, Y1, A) %>%
mutate(Y=ifelse(A, Y1, Y0))
df %>%
group_by(A) %>%
summarise(mu=mean(Y)) %>%
summarise(ave_diff=diff(mu))
df %>%
filter(A) %>%
mutate(diff=Y1-Y0) %>%
mean
df %>%
filter(A) %>%
mutate(diff=Y1-Y0) %>%
mean(diff)
df %>%
filter(A==1) %>%
mutate(diff=Y1-Y0) %>%
mean(diff)
df %>%
filter(A==1) %>%
summarise(ave_diff=mean(Y1-Y0))
set .seed(2610)
set .seed(2610)
set.seed(2610)
A_ star = rbinom (n, 1, 0.4)
set.seed(2610)
A_star = rbinom (n, 1, 0.4)
df <- data.frame(X, U, Y0, Y1, A_star) %>%
mutate(Y=ifelse(A_star, Y1, Y0))
df %>%
group_by(A_star) %>%
summarise(mu=mean(Y)) %>%
summarise(ave_diff=diff(mu))
df %>%
filter(A_star==1) %>%
summarise(ave_diff=mean(Y1-Y0))
options(digits=4)
set.seed(2610)
n = 10000
X = rnorm(n, 0, 1)
U = rnorm(n, 0, 2)
Y0 = rnorm(n, 0, 1)
Y1 = rnorm(n, Y0 + 0.8 + 0.1 *X + 0.3 *U, 0.5)
A = rbinom(n, 1, plogis (-1 + 1.0*X + 0.5*U))
df <- data.frame(X, U, Y0, Y1, A) %>%
mutate(Y=ifelse(A, Y1, Y0))
df %>%
group_by(A) %>%
summarise(mu=mean(Y)) %>%
summarise(ave_diff=diff(mu))
df %>%
filter(A==1) %>%
summarise(ave_diff=mean(Y1-Y0))
set.seed(2610)
A_star = rbinom (n, 1, 0.4)
df <- data.frame(X, U, Y0, Y1, A_star) %>%
mutate(Y=ifelse(A_star, Y1, Y0))
df %>%
group_by(A_star) %>%
summarise(mu=mean(Y)) %>%
summarise(ave_diff=diff(mu))
df %>%
filter(A_star==1) %>%
summarise(ave_diff=mean(Y1-Y0))
set.seed (2610)
n = 500
X = rnorm(n , 0 , 1)
Y0 = rnorm(n , ( X +0.5) ^2 , 1)
Y1 = rnorm(n , 0.5 + (X -0.5) ^2 , 1)
A = rbinom(n , 1 , plogis ( -1 + 3.0*X ))
col1 = ifelse( A == 0 , "red ", " lightpink ")
col2 = ifelse( A == 1 , " blue ", " skyblue ")
pch1 = ifelse( A == 0 , 19 , 1)
pch2 = ifelse( A == 1 , 19 , 1)
plot (X , Y0 , col = col1 , pch = pch1 , ylab = " Outcome ", xlab = "X")
points (X , Y1 , col = col2 , pch = pch2)
df <- data.frame(X, Y0, Y1, A) %>%
mutate(Y=ifelse(A, Y1, Y0))
mdl <- lm(Y ~ A + X + X^2, data=df)
coef(mdl)["A"]
set.seed (2610)
A_star = rbinom(n , 1 , 0.5)
df <- data.frame(X, Y0, Y1, A_star) %>%
mutate(Y=ifelse(A, Y1, Y0))
mdl <- lm(Y ~ A_star + X + X^2, data=df)
coef(mdl)["A_star"]
df <- data.frame(X, Y0, Y1, A) %>%
mutate(Y=ifelse(A, Y1, Y0))
mdl <- lm(Y ~ A + X + I(X^2), data=df)
coef(mdl)["A"]
